---
layout: post
title: 用Dockers搭建本地开发环境
date: 2017-09-18 10:19:55.000000000 +08:00
---

## 常用命令


### 镜像

搜索镜像

`$ docker search xxx`

如果出现 connection refused  可以试试重启docker

下载镜像

`$ docker pull xxx`

删除镜像

`$ docker rmi xxx`


本地容器保存快照 生成镜像压缩文件

`$ docker export -o dev-latest.tar 7e4b0`

导入镜像

`$    `

保存镜像

`$ docker save -o redis-latest.tar 9813`


容器导入 是将当前容器 变成一个新的镜像
镜像导入 是复制的过程

save 保存镜像所有的信息-包含历史
export 只导出当前的信息


### 容器

查看当前运行的容器

`$ docker ps`
`$ docker ps -a`

`$ docker stats`

`$ docker top`

查看当前docker版本

`$ docker info`

运行容器

`$ docker run -d [-p 主机端口:容器端口] --name [容器名自定义]  [-v 主机/目录:容器/目录]  [镜像名] `

例如

centos

`$ docker run -d -p 80:80 --name dev -v D:/docker/dev/www:/home/www centos`

redis
`$ docker run -d -p 6379:6379 --name dev-redis -v D:/docker/redis/data:/data redis`

mysql

`$ docker run --name dev-mysql -v D:/docker/mysql:/var/lib/mysql -p 3306:3306 -e MYSQL_ROOT_PASSWORD=111111 -d mysql`

停止 开启 重启 

`$ docker stop`
`$ docker start`
`$ docker restart`

删除容器

`$ docker rm `

如果有自己的仓库可以

`$ docker login -u 用户名 -p 密码 仓库地址`

进入容器

`$ docker exec -it [容器名] /bin/bash`



如果碰到开机报错：
```
Docker command did not complete within the allowed timeout. Output:
```
可能是windows 防火墙问题

在防火墙里放开下面这俩exe
`C:\Program Files\Docker\Docker\Docker for Windows.exe`
`C:\Program Files\Docker\Docker\DockerCli.exe`


PS 如果发现容器里面挂载的目录不见了
但是执行 docker inspect 发现这个配置其实是有的

那么  可能是挂载的主机磁盘没有写权限 改完后重启试试


### 容器间通信

默认可以用内网IP通信 网段是 172.17.0.1...

可以通过下面的命令查看容器IP

`$ docker inspect --format='{{.NetworkSettings.IPAddress}}' CONTAINER_ID`

